import requests
import pymysql
import xmltodict
import pprint
import json
import mysql.connector
 
# Request line pulls data from API and pulls NJ Campground info under my API Key.
r =requests.get('http://api.amp.active.com/camping/campgrounds/?pstate=NJ&api_key=APIKEY')

# Extra b' at the beginning in xml had to use a text format input to pull data.

test = '<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<resultset count="44" pstate="NJ" resultType="campgrounds">\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760106" facilityName="Adventure Bound Camping Resorts Cape May" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.072" listingOnly="Y" longitude="-74.8437" regionName="" shortName="MB1581" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750308" facilityName="ALLAIRE STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.1566667" listingOnly="Y" longitude="-74.1322222" regionName="" shortName="NJ0308" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722487" facilityName="Atlantic Shore Pines Campground" faciltyPhoto="/webphotos/INDP/pid722487/0/80x53.jpg" favorite="N" latitude="39.61115" listingOnly="Y" longitude="-74.4082389" regionName="" shortName="GS2387" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750315" facilityName="ATSION RECREATION AREA" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.7161111" listingOnly="Y" longitude="-74.7972222" regionName="" shortName="NJ0315" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750316" facilityName="BASS RIVER STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.6338889" listingOnly="Y" longitude="-74.4069444" regionName="" shortName="NJ0316" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760282" facilityName="BEACHCOMBER CAMPING RESORT" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.0068611" listingOnly="Y" longitude="-74.893" regionName="" shortName="MCUS71" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750317" facilityName="BELLEPLAIN STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.2891667" listingOnly="Y" longitude="-74.8269444" regionName="" shortName="NJ0317" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750318" facilityName="BRENDAN T BYRNE STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.9075" listingOnly="Y" longitude="-74.4755556" regionName="" shortName="NJ0318" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760245" facilityName="Buena Vista RV Resort" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.5249722" listingOnly="Y" longitude="-74.9382083" regionName="" shortName="MC1772" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750309" facilityName="BULLS ISLAND STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="" listingOnly="Y" longitude="" regionName="" shortName="NJ0309" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="KOAI" contractType="PRIVATE" facilityID="730181" facilityName="Cape May KOA" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="38.9811639" listingOnly="Y" longitude="-74.9007556" regionName="" shortName="K0081" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750310" facilityName="CHEESEQUAKE STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.4347222" listingOnly="Y" longitude="-74.2636111" regionName="" shortName="NJ0310" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="ELSI" contractType="PRIVATE" facilityID="740113" facilityName="Chestnut Lake RV Campground" faciltyPhoto="/webphotos/ELSI/pid740113/0/80x53.jpg" favorite="N" latitude="39.5416333" listingOnly="Y" longitude="-74.4692528" regionName="" shortName="A113" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722585" facilityName="Country Oaks Campground" faciltyPhoto="/webphotos/INDP/pid722585/0/80x53.jpg" favorite="N" latitude="39.4162611" listingOnly="Y" longitude="-74.8360389" regionName="" shortName="GS2485" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722371" facilityName="Fla-Net Park" faciltyPhoto="/webphotos/INDP/pid722371/0/80x53.jpg" favorite="N" latitude="40.8889306" listingOnly="Y" longitude="-74.71035" regionName="" shortName="GS2271" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760278" facilityName="Four Seasons Family Campground" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.6163889" listingOnly="Y" longitude="-75.2756917" regionName="" shortName="MCUS21" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750301" facilityName="HIGH POINT STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.3064" listingOnly="Y" longitude="-74.6707722" regionName="" shortName="NJ0301" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722938" facilityName="Holly Acres Campground" faciltyPhoto="/webphotos/INDP/pid722938/0/80x53.jpg" favorite="N" latitude="39.5262972" listingOnly="Y" longitude="-74.5995" regionName="" shortName="GS2838" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722636" facilityName="Indian Rock RV Park" faciltyPhoto="/webphotos/INDP/pid722636/0/80x53.jpg" favorite="N" latitude="40.1004194" listingOnly="Y" longitude="-74.4154889" regionName="" shortName="GS2536" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750302" facilityName="JENNY JUMP STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.9172222" listingOnly="Y" longitude="-74.9144444" regionName="" shortName="NJ0302" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750321" facilityName="KITTATINNY VALLEY STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.0163889" listingOnly="Y" longitude="-74.7438889" regionName="" shortName="NJ0321" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="ELSI" contractType="PRIVATE" facilityID="740141" facilityName="Lake and Shore RV Resort" faciltyPhoto="/webphotos/ELSI/pid740141/0/80x53.jpg" favorite="N" latitude="39.1986694" listingOnly="Y" longitude="-74.7368306" regionName="" shortName="A141" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="ELSI" contractType="PRIVATE" facilityID="740500" facilityName="Mays Landing RV Resort" faciltyPhoto="/webphotos/ELSI/pid740500/0/80x53.jpg" favorite="N" latitude="39.4180833" listingOnly="Y" longitude="-74.7990833" regionName="" shortName="A500" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="PRCG" contractType="PRIVATE" facilityID="1066402" facilityName="Old Cedar Campground" faciltyPhoto="/webphotos/PRCG/pid1066402/0/80x53.jpg" favorite="N" latitude="39.6408333" listingOnly="N" longitude="-75.1755556" regionName="" shortName="B402" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="Y" sitesWithWaterHookup="Y" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750319" facilityName="PARVIN STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.5133333" listingOnly="Y" longitude="-75.1525" regionName="" shortName="NJ0319" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="KOAI" contractType="PRIVATE" facilityID="730462" facilityName="Philadelphia South / Clarksboro KOA" faciltyPhoto="/webphotos/KOAI/pid730462/0/80x53.jpg" favorite="N" latitude="39.8077" listingOnly="Y" longitude="-75.2367" regionName="" shortName="K0362" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="723031" facilityName="Pleasant Acres Farm RV Resort" faciltyPhoto="/webphotos/INDP/pid723031/0/80x53.jpg" favorite="N" latitude="41.2775889" listingOnly="Y" longitude="-74.6398111" regionName="" shortName="GS2931" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722559" facilityName="Pomona RV Park" faciltyPhoto="/webphotos/INDP/pid722559/0/80x53.jpg" favorite="N" latitude="39.474525" listingOnly="Y" longitude="-74.5839778" regionName="" shortName="GS2459" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750311" facilityName="ROUND VALLEY RA" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.6227583" listingOnly="Y" longitude="-74.8550361" regionName="" shortName="NJ0311" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="ELSI" contractType="PRIVATE" facilityID="740214" facilityName="Sea Pines RV Resort and Campground" faciltyPhoto="/webphotos/ELSI/pid740214/0/80x53.jpg" favorite="N" latitude="39.1322222" listingOnly="Y" longitude="-74.7768083" regionName="" shortName="A214" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750312" facilityName="SPRUCE RUN RECREATION AREA" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.6619444" listingOnly="Y" longitude="-74.9413889" regionName="" shortName="NJ0312" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750303" facilityName="STEPHENS STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.8702778" listingOnly="Y" longitude="-74.8163889" regionName="" shortName="NJ0303" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750304" facilityName="STOKES STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.1856361" listingOnly="Y" longitude="-74.7956889" regionName="" shortName="NJ0304" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760253" facilityName="Surf and Stream Campground" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.0032528" listingOnly="Y" longitude="-74.2353167" regionName="" shortName="MC1900" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750305" facilityName="SWARTSWOOD STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.0738056" listingOnly="Y" longitude="-74.8187833" regionName="" shortName="NJ0305" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722520" facilityName="Tip Tam Camping Resort" faciltyPhoto="/webphotos/INDP/pid722520/0/80x53.jpg" favorite="N" latitude="40.1006806" listingOnly="Y" longitude="-74.2718806" regionName="" shortName="GS2420" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="INDP" contractType="PRIVATE" facilityID="722579" facilityName="TripleBrook Camping Resort" faciltyPhoto="/webphotos/INDP/pid722579/0/80x53.jpg" favorite="N" latitude="40.91205" listingOnly="Y" longitude="-75.0191" regionName="" shortName="GS2479" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750313" facilityName="VOORHEES STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.6894444" listingOnly="Y" longitude="-74.8955556" regionName="" shortName="NJ0313" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750314" facilityName="WASHINGTON CROSSING STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.3111111" listingOnly="Y" longitude="-74.8633333" regionName="" shortName="NJ0314" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750306" facilityName="WAWAYANDA STATE PARK" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.1833333" listingOnly="Y" longitude="-74.4494444" regionName="" shortName="NJ0306" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750320" facilityName="WHARTON STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.6444444" listingOnly="Y" longitude="-74.6469444" regionName="" shortName="NJ0320" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760279" facilityName="Whippoorwill Campground" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="39.2485889" listingOnly="Y" longitude="-74.6685917" regionName="" shortName="MCUS27" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="MMIS" contractType="PRIVATE" facilityID="760218" facilityName="Woodland Trails" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="41.2222472" listingOnly="Y" longitude="-74.5333361" regionName="" shortName="MB2652" sitesWithAmps="N" sitesWithPetsAllowed="N" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="" state="NJ"/>\n<result agencyIcon="" agencyName="" contractID="SLST" contractType="STATE" facilityID="750307" facilityName="WORTHINGTON STATE FOREST" faciltyPhoto="/images/nophoto.jpg" favorite="N" latitude="40.9916667" listingOnly="Y" longitude="-75.0911111" regionName="" shortName="NJ0307" sitesWithAmps="Y" sitesWithPetsAllowed="Y" sitesWithSewerHookup="N" sitesWithWaterHookup="N" sitesWithWaterfront="Lakefront" state="NJ"/>\n</resultset>\n'


pp = pprint.PrettyPrinter(indent=4)
result = xmltodict.parse(test)
print(result)

#Parsing data into 3 categories to work in the groups selection of data.
facilityName = result["resultset"]['result'][0]['@facilityName']
sitesWithPetsAllowed = result["resultset"]['result'][1]['@sitesWithPetsAllowed']
sitesWithSewerHookup = result["resultset"]['result'][2]['@sitesWithSewerHookup']

# Print categories.
print(facilityName)
print(sitesWithPetsAllowed)
print(sitesWithSewerHookup)


#Connect information to sql
mydb = pymysql.connect(host = "localhost", user = "root", passwd ="6U(iKnV-OcEl.5fE", db ="my_data", port = 3307)
mycursor = mydb.cursor()

# Inputs data into a table called campground2
sql = "Insert INTO campground2 (facilityName, sitesWithPetsAllowed, sitesWithSewerHookup) VALUES (%s,%s,%s)"
val = (facilityName, sitesWithPetsAllowed, sitesWithSewerHookup)
mycursor.execute(sql,val)
# Commits data transferred.
mydb.commit()

print(mycursor.rowcount, "record inserted.")
